import pyspark.sql
data = sc.textFile("/home/bigdatalab27/Downloads/mernis/data_dump_temp.sql")
data = data.filter(lambda line:line!='')
data = data.map(lambda lines:lines.split("\t"))
data = data.map(lambda line:(line[2]+" "+line[3],line[6]))
list_dataframe = sqlContext.createDataFrame(data,['name','gender'])
list_dataframe.registerTempTable("test")
result = sqlContext("""SELECT name,COUNT(*) as count FROM test WHERE gender = 'E' GROUP BY name ORDER BY count DESC""")
result.show(5)
result = sqlContext("""SELECT name,COUNT(*) as count FROM test WHERE gender = 'K' GROUP BY name ORDER BY count DESC""")
result.show(5)