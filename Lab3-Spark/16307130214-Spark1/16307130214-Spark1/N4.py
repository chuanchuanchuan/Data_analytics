data = sc.textFile("/home/bigdatalab27/Downloads/mernis/data_dump_temp.sql")
data = data.filter(lambda line:line!='')
data = data.map(lambda lines:lines.split("\t"))
data = data.map(lambda line:((line[9],line[3]),1))
data.reduceByKey(lambda x,y:x+y)
data = data.map(lambda line:(line[0][0],(line[0][1],line[1])))
data = data.groupByKey()
data.map(lambda line:(line[0],sorted(line[1],key=lambda d:d[1],reverse=True)))
data = data.map(lambda line:(line[0],(line[1][0][0],line[1][1][0],line[1][2][0])))
data1 = sc.textFile("/home/bigdatalab27/Downloads/mernis/data_dump_temp.sql")
data1 = data1.filter(lambda line:line!='')
data1 = data1.map(lambda lines:lines.split("\t"))
data1 = data1.map(lambda line:((line[9]),1))
data1 = data1.reduceByKey(lambda line:(line[1],line[0]))
data1.sortByKey().collect()
country_top10 = ['SANLIURFA','ADANA','AYDIN','SAMSUN','SIVAS','BURSA',\
                 'ANKARA','IZMIR','KONYA','ISTANBUL']
result = data.filter(lambda line:line[0] in country_top10)
result.collect()